{% comment %} Blog Section {% endcomment %}
<section class="p_blog">
  <!-- p_mainvisual -->
  <section class="p_mainvisual">
    <div class="p_mainvisual_inner">
      <h1 class="p_mainvisual_title">{{ section.settings.hero_title | default: 'Our Blog' }}</h1>
      <p class="p_mainvisual_desc">
        {{ section.settings.hero_description | default: 'Stay informed with the latest news, tips, and insights about hydration, health, and our commitment to quality.' }}
      </p>
    </div>
  </section>
  
  <div id="content">
    <!-- blog_featured -->
    {% if section.settings.show_featured and section.settings.featured_article != blank %}
      <section id="blog_featured">
        <div class="blog_featured_inner">
          {%- assign featured_article = blogs[blog.handle].articles[section.settings.featured_article] -%}
          {% if featured_article %}
            <div class="blog_featured_card">
              <div class="blog_featured_image">
                {% if featured_article.image %}
                  {{ featured_article.image | image_url: width: 800 | image_tag: alt: featured_article.title }}
                {% else %}
                  {{ 'images/blog/featured.jpg' | asset_url | image_tag: alt: featured_article.title }}
                {% endif %}
              </div>
              <div class="blog_featured_content">
                <span class="blog_featured_badge">Featured Post</span>
                <h2 class="blog_featured_title">{{ featured_article.title }}</h2>
                <p class="blog_featured_excerpt">{{ featured_article.excerpt_or_content | strip_html | truncate: 150 }}</p>
                <div class="blog_featured_meta">
                  <div class="blog_meta_item">
                    <svg class="blog_meta_icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                      <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                      <line x1="16" y1="2" x2="16" y2="6"/>
                      <line x1="8" y1="2" x2="8" y2="6"/>
                      <line x1="3" y1="10" x2="21" y2="10"/>
                    </svg>
                    <span>{{ featured_article.published_at | date: "%b %d, %Y" }}</span>
                  </div>
                  <div class="blog_meta_item">
                    <svg class="blog_meta_icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                      <circle cx="12" cy="12" r="10"/>
                      <polyline points="12 6 12 12 16 14"/>
                    </svg>
                    <span>{{ featured_article.content | strip_html | split: ' ' | size | divided_by: 200 }} min read</span>
                  </div>
                </div>
                <a href="{{ featured_article.url }}" class="btn_primary">
                  <span>Read More</span>
                  <svg class="btn_icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M5 12h14M12 5l7 7-7 7"/>
                  </svg>
                </a>
              </div>
            </div>
          {% endif %}
        </div>
      </section>
    {% endif %}

    <!-- blog_list -->
    <section id="blog_list">
      <div class="blog_list_inner">
        <div class="blog_list_grid">
          {% paginate blog.articles by section.settings.articles_per_page %}
            {% for article in blog.articles %}
              <div class="blog_list_card">
                <div class="blog_list_image">
                  {% if article.image %}
                    {{ article.image | image_url: width: 600 | image_tag: alt: article.title }}
                  {% else %}
                    {{ 'images/blog/post01.jpg' | asset_url | image_tag: alt: article.title }}
                  {% endif %}
                </div>
                <div class="blog_list_content">
                  <h3 class="blog_list_title">{{ article.title }}</h3>
                  <p class="blog_list_excerpt">{{ article.excerpt_or_content | strip_html | truncate: 120 }}</p>
                  <div class="blog_list_meta">
                    <div class="blog_meta_item">
                      <svg class="blog_meta_icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                        <line x1="16" y1="2" x2="16" y2="6"/>
                        <line x1="8" y1="2" x2="8" y2="6"/>
                        <line x1="3" y1="10" x2="21" y2="10"/>
                      </svg>
                      <span>{{ article.published_at | date: "%b %d, %Y" }}</span>
                    </div>
                    <div class="blog_meta_item">
                      <svg class="blog_meta_icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12 6 12 12 16 14"/>
                      </svg>
                      <span>{{ article.content | strip_html | split: ' ' | size | divided_by: 200 }} min read</span>
                    </div>
                  </div>
                  <a href="{{ article.url }}" class="blog_list_link">
                    Read More
                    <svg class="blog_link_icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                      <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                  </a>
                </div>
              </div>
            {% endfor %}

            {% if paginate.pages > 1 %}
              <div class="blog_pagination">
                {% if paginate.previous %}
                  <a href="{{ paginate.previous.url }}" class="blog_pagination_link">Previous</a>
                {% endif %}
                
                {% for part in paginate.parts %}
                  {% if part.is_link %}
                    <a href="{{ part.url }}" class="blog_pagination_link">{{ part.title }}</a>
                  {% else %}
                    <span class="blog_pagination_link is-active">{{ part.title }}</span>
                  {% endif %}
                {% endfor %}

                {% if paginate.next %}
                  <a href="{{ paginate.next.url }}" class="blog_pagination_link">Next</a>
                {% endif %}
              </div>
            {% endif %}
          {% endpaginate %}
        </div>
      </div>
    </section>

    <!-- blog_newsletter -->
    {% if section.settings.show_newsletter %}
      <section id="blog_newsletter">
        <div class="blog_newsletter_inner">
          <div class="blog_newsletter_card">
            <h2 class="blog_newsletter_title">{{ section.settings.newsletter_title | default: 'Subscribe to Our Newsletter' }}</h2>
            <p class="blog_newsletter_desc">
              {{ section.settings.newsletter_description | default: 'Get the latest articles, tips, and exclusive offers delivered straight to your inbox.' }}
            </p>
            {% form 'customer', class: 'blog_newsletter_form' %}
              <input type="hidden" name="contact[tags]" value="newsletter">
              <input type="email" name="contact[email]" placeholder="Enter your email" class="blog_newsletter_input" required>
              <button type="submit" class="btn_primary">{{ section.settings.newsletter_button_text | default: 'Subscribe' }}</button>
            {% endform %}
          </div>
        </div>
      </section>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Blog",
  "settings": [
    {
      "type": "header",
      "content": "Hero Section"
    },
    {
      "type": "text",
      "id": "hero_title",
      "label": "Hero Title",
      "default": "Our Blog"
    },
    {
      "type": "textarea",
      "id": "hero_description",
      "label": "Hero Description",
      "default": "Stay informed with the latest news, tips, and insights about hydration, health, and our commitment to quality."
    },
    {
      "type": "header",
      "content": "Featured Article"
    },
    {
      "type": "checkbox",
      "id": "show_featured",
      "label": "Show Featured Article",
      "default": true
    },
    {
      "type": "article",
      "id": "featured_article",
      "label": "Featured Article"
    },
    {
      "type": "header",
      "content": "Blog List"
    },
    {
      "type": "range",
      "id": "articles_per_page",
      "label": "Articles Per Page",
      "min": 3,
      "max": 24,
      "step": 3,
      "default": 9
    },
    {
      "type": "header",
      "content": "Newsletter Section"
    },
    {
      "type": "checkbox",
      "id": "show_newsletter",
      "label": "Show Newsletter Section",
      "default": true
    },
    {
      "type": "text",
      "id": "newsletter_title",
      "label": "Newsletter Title",
      "default": "Subscribe to Our Newsletter"
    },
    {
      "type": "textarea",
      "id": "newsletter_description",
      "label": "Newsletter Description",
      "default": "Get the latest articles, tips, and exclusive offers delivered straight to your inbox."
    },
    {
      "type": "text",
      "id": "newsletter_button_text",
      "label": "Newsletter Button Text",
      "default": "Subscribe"
    }
  ]
}
{% endschema %}
